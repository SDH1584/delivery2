<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="Business">

	<!-- 가게정보 -->
	<select id="getUser" parameterType="int" resultType="BusinessVo">
		<![CDATA[
			SELECT
					store_no as storeNo,
					no,
					biz_no as bizNo,
					store_name as storeName,
					store_phone as storePhone,
					store_m_adr as storeMAdr,
					store_s_adr as storeSAdr,
					store_lat as storeLat,
					store_lng as sotreLng,
					logo_img as logoImg,
					min_price as minPrice,
					notice,
					origin as origin,
					on_off as onOff
			FROM BUSINESS
			where store_no = #{store_no}
		]]>
	</select>

	<!-- 유저정보 -->
	<select id="getuser" parameterType="int" resultType="UserVo">
		<![CDATA[
			SELECT
    			* FROM USERS
    		where no = #{no}
		]]>
	</select>



	<!-- 유저 업데이트 -->

	<update id="Userupdate" parameterType="UserVo">
		<![CDATA[
			update users
			set    hp = #{hp},
       			   email = #{email}
			where  no = #{no}
		]]>
	</update>

	<!-- 가게정보 업데이트 -->
	<update id="BusinessUpdate" parameterType="BusinessVo">
		<![CDATA[
			update BUSINESS
			set   	
					store_name = #{storeName},
					store_phone = #{storePhone},
					store_m_adr = #{storeMAdr},
					store_s_adr = #{storeSAdr},
					min_price = #{minPrice},
					origin = #{origin},
					logo_img = #{logoImg},
					notice = #{notice}
			where  store_no = #{storeNo}
		]]>
	</update>

	<!-- 메뉴 카테고리 추가 -->
	<insert id="menucateadd" parameterType="MenucateVo">
		<![CDATA[
				
				insert into menu_cate 
				values(seq_menu_cate.nextval, #{store_no}, #{menu_cate_name} )
		]]>
	</insert>

	<!-- 메뉴 카테고리 리스트 -->
	<select id="menucatelist" parameterType="MenucateVo"
		resultType="MenucateVo">
		<![CDATA[
			 	select 
						menu_cate_no,
						store_no,
						menu_cate_name
			 	from	menu_cate
			 	where store_no = #{store_no}
		]]>
	</select>

	<!-- 메뉴 등록 -->
	<insert id="menuadd" parameterType="MenuVo">
		<![CDATA[
				
				insert into menu 
				values(seq_menu.nextval, #{menu_cate_no}, #{menu_img}, #{menu_name} , #{menu_price} , #{menu_desc})
		]]>
	</insert>

	<!-- 메뉴 리스트 파라미터 -->
	<select id="menulistpar" parameterType="MenuVo"
		resultType="MenuVo">
		<![CDATA[
			 	select 
			 			menu_no,
						menu_cate_no,
						menu_img,
						menu_name,
						menu_price,
						menu_desc
			 	from	menu
			 	where menu_cate_no= #{menu_cate_no}
		]]>
	</select>

	<!-- 가게 카테고리 등록 -->
	<insert id="storecateadd" parameterType="StorecateVo">
		<selectKey keyProperty="store_cate_no" resultType="int"
			order="BEFORE">
			select seq_store_cate.nextval from dual
		</selectKey>
		<![CDATA[
				
				insert into store_cate 
				values(#{store_cate_no}, #{store_cate_name})
		]]>
	</insert>

	<!-- 가게 다대다 키 등록 -->
	<insert id="storecate" parameterType="BizstorecateVo">
		
		<![CDATA[
				
				insert into biz_store_cate 
				values(seq_biz_store_cate.nextval, #{store_cate_no},#{store_no})
		]]>
	</insert>
</mapper>
